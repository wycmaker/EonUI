import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r as d,R as C}from"./iframe-DtrAF50Y.js";import{c as s}from"./cn-Dtjc6EhN.js";import{S as W,c as Z,d as Q,e as U}from"./icons-B4aNx7RA.js";const w={default:"border border-gray-200",bordered:"border-2 border-gray-300"},c=(r,g)=>Array.isArray(r)?r.includes(g):r===g,X=r=>c(r,"bordered")?w.bordered:w.default,Y={sm:"text-xs",md:"text-base",lg:"text-lg"},_={sm:"px-2 py-1.5",md:"px-4 py-3",lg:"px-6 py-5"},ee=({direction:r})=>t.jsxs("span",{className:"ml-2 inline-flex flex-col",children:[t.jsx(Q,{className:s("h-4 w-4 transition-colors font-bold",r==="asc"?"text-primary-600":"text-gray-500")}),t.jsx(U,{className:s("h-4 w-4 -mt-2 transition-colors font-bold",r==="desc"?"text-primary-600":"text-gray-500")})]}),ue=()=>t.jsxs("div",{className:"flex items-center justify-center py-8",children:[t.jsx(W,{className:"h-8 w-8 text-primary-600 animate-spin"}),t.jsx("span",{className:"ml-2 text-gray-600 animate-pulse",children:"載入中..."})]}),te=({text:r})=>t.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500",children:[t.jsx(Z,{className:"mr-2"}),r]}),F=r=>null,B=({columns:r=[],defaultSortConfig:g={key:"",direction:null},onSortChange:m,sortable:R=!0,variant:o="default",size:A="md",hover:N=!0,stickyHeader:$=!1,maxHeight:V,maxWidth:S,loading:z=!1,emptyText:I="暫無資料",className:K,renderCell:D,children:b,value:p,onChange:E,onBlur:v})=>{const[n,k]=d.useState(g);d.useEffect(()=>{},[p,E]);const j=d.useMemo(()=>{const e=[];return C.Children.forEach(b,a=>{if(C.isValidElement(a)&&a.type===F){const u=a.props;e.push({key:u.dataKey,title:u.title||String(u.dataKey),width:u.width,sortable:u.sortable,align:u.align,fixed:u.fixed})}}),e},[b]),q=d.useMemo(()=>[...r,...j],[r,j]),h=d.useMemo(()=>m||!n.key||!n.direction?p:[...p].sort((e,a)=>{const u=e[n.key],l=a[n.key];if(u===l)return 0;let i=0;return u>l?i=1:u<l&&(i=-1),n.direction==="desc"?i*-1:i}),[p,n,m]),L=d.useCallback(e=>{const a={key:e,direction:n.key===e&&n.direction==="asc"?"desc":n.key===e&&n.direction==="desc"?null:"asc"};m?(k(a),m(a)):k(a)},[n,m]),T=d.useCallback(e=>{E&&E(e)},[E]),H=d.useCallback((e,a,u,l)=>{let i;return C.Children.forEach(b,f=>{if(C.isValidElement(f)&&f.type===F){const y=f.props;y.dataKey===l&&y.children&&(i=y.children)}}),i?i(e,a,u,y=>{const x=[...h];x[u]&&(x[u]={...x[u],[l]:y}),T(x)}):D?D(e,a,u,l):e==null?"-":typeof e=="boolean"?e?"是":"否":typeof e=="object"?JSON.stringify(e):String(e)},[b,D,h,T]),M=d.useCallback(()=>{v&&v()},[v]),G=s("overflow-auto",V&&`max-h-[${V}]`,S&&`max-w-[${S}]`,K),J=s("w-full table-fixed",X(o),Y[A],"bg-white"),O=()=>t.jsx("thead",{className:s("bg-gray-50",$&&"sticky top-0 z-10"),children:t.jsx("tr",{children:q.map((e,a)=>{const u=R&&e.sortable,l=n.key===String(e.key);return t.jsx("th",{scope:"col",className:s(_[A],"font-semibold text-gray-900 border-b border-gray-200 align-middle",c(o,"bordered")&&"border-r border-gray-200 last:border-r-0","break-words",e.align==="center"&&"text-center",e.align==="right"&&"text-right",u&&"cursor-pointer hover:bg-gray-100 select-none",e.fixed==="left"&&"sticky left-0 bg-gray-50 z-20",e.fixed==="right"&&"sticky right-0 bg-gray-50 z-20"),style:{width:e.width},onClick:u?()=>L(String(e.key)):void 0,"aria-sort":u&&l?n.direction==="asc"?"ascending":n.direction==="desc"?"descending":"none":void 0,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{children:e.title}),u&&t.jsx(ee,{direction:l?n.direction:null})]})},`header-${a}-${String(e.key)}`)})})}),P=()=>t.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map((e,a)=>t.jsx("tr",{className:s(c(o,"striped")&&a%2===1&&"bg-gray-100",N&&c(o,"striped")&&"hover:bg-gray-200 transition-colors",N&&!c(o,"striped")&&"hover:bg-gray-50 transition-colors"),children:q.map((u,l)=>{const i=e[u.key],f=H(i,e,a,u.key);return t.jsx("td",{className:s(_[A],"border-b border-gray-200",c(o,"bordered")&&"border-r border-gray-200 last:border-r-0","break-words",c(o,"striped")&&a%2===1?"bg-gray-100":"bg-white",u.align==="center"&&"text-center",u.align==="right"&&"text-right",u.fixed==="left"&&"sticky left-0 z-10",u.fixed==="right"&&"sticky right-0 z-10"),style:{width:u.width},children:t.jsx("div",{className:"w-full",children:f})},`cell-${a}-${l}-${String(u.key)}`)})},`row-${a}-${e.id||a}`))});return t.jsx("div",{className:G,onBlur:M,children:z?t.jsx(ue,{}):h.length===0?t.jsx(te,{text:I}):t.jsxs("table",{className:J,role:"table",children:[O(),P()]})})};B.displayName="Table";F.displayName="TableColumn";try{F.displayName="TableColumn",F.__docgenInfo={description:"",displayName:"TableColumn",props:{dataKey:{defaultValue:null,description:"欄位鍵名",name:"dataKey",required:!0,type:{name:"string | number | symbol"}},title:{defaultValue:null,description:"欄位標題",name:"title",required:!1,type:{name:"string | undefined"}},width:{defaultValue:null,description:"欄位寬度",name:"width",required:!1,type:{name:"string | number | undefined"}},sortable:{defaultValue:{value:"true"},description:"是否可排序",name:"sortable",required:!1,type:{name:"boolean | undefined"}},align:{defaultValue:null,description:"文字對齊方式",name:"align",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"center"'},{value:'"left"'},{value:'"right"'}]}},fixed:{defaultValue:null,description:"是否固定欄位",name:"fixed",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"left"'},{value:'"right"'}]}},className:{defaultValue:null,description:"自訂 CSS 類名",name:"className",required:!1,type:{name:"string | undefined"}},children:{defaultValue:null,description:"自訂渲染函數（children 函數）",name:"children",required:!1,type:{name:"((value: unknown, record: T, index: number, updateField: (newValue: unknown) => void) => ReactNode) | undefined"}}}}}catch{}try{B.displayName="Table",B.__docgenInfo={description:"",displayName:"Table",props:{columns:{defaultValue:{value:"[]"},description:"欄位定義（可選，也可使用 TableColumn 子組件）",name:"columns",required:!1,type:{name:"ColumnDef<T>[] | undefined"}},defaultSortConfig:{defaultValue:{value:"{ key: '', direction: null }"},description:"預設排序配置",name:"defaultSortConfig",required:!1,type:{name:"SortConfig | undefined"}},onSortChange:{defaultValue:null,description:`排序變更回調
- 如果提供：外部控制排序模式，需要外部處理排序邏輯並更新 value
- 如果不提供：內部自動排序模式，Table 會自動對 value 進行排序`,name:"onSortChange",required:!1,type:{name:"((sortConfig: SortConfig) => void) | undefined"}},sortable:{defaultValue:{value:"true"},description:"是否可以排序",name:"sortable",required:!1,type:{name:"boolean | undefined"}},variant:{defaultValue:{value:"default"},description:"表格樣式變體（可以是單一樣式或多個樣式的陣列）",name:"variant",required:!1,type:{name:'"default" | "striped" | "bordered" | ("striped" | "bordered")[] | undefined'}},size:{defaultValue:{value:"md"},description:"表格大小",name:"size",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"sm"'},{value:'"md"'},{value:'"lg"'}]}},hover:{defaultValue:{value:"true"},description:"是否顯示 hover 效果",name:"hover",required:!1,type:{name:"boolean | undefined"}},stickyHeader:{defaultValue:{value:"false"},description:"是否固定表頭",name:"stickyHeader",required:!1,type:{name:"boolean | undefined"}},maxHeight:{defaultValue:null,description:"表格最大高度（啟用垂直滾動）",name:"maxHeight",required:!1,type:{name:"string | number | undefined"}},maxWidth:{defaultValue:null,description:"表格最大寬度（啟用水平滾動）",name:"maxWidth",required:!1,type:{name:"string | number | undefined"}},loading:{defaultValue:{value:"false"},description:"載入狀態",name:"loading",required:!1,type:{name:"boolean | undefined"}},emptyText:{defaultValue:{value:"暫無資料"},description:"空資料顯示文字",name:"emptyText",required:!1,type:{name:"string | undefined"}},className:{defaultValue:null,description:"自訂 CSS 類名",name:"className",required:!1,type:{name:"string | undefined"}},renderCell:{defaultValue:null,description:"自訂單元格渲染函數",name:"renderCell",required:!1,type:{name:"((value: unknown, record: T, index: number, key: keyof T) => ReactNode) | undefined"}},children:{defaultValue:null,description:"子元素",name:"children",required:!1,type:{name:"ReactNode"}},value:{defaultValue:null,description:"表格資料",name:"value",required:!0,type:{name:"T[]"}},onChange:{defaultValue:null,description:"值變更回調",name:"onChange",required:!1,type:{name:"((data: T[]) => void) | undefined"}},onBlur:{defaultValue:null,description:"失焦事件",name:"onBlur",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}export{B as T,F as a};
